INFO:__main__:ğŸ” Enhanced detailed logging enabled - output: /mnt/c/Users/chris/Cloud-Drive_christianhaddad8@Gmail.com/Cloud-Drive/Full/claude code/Amazon-FBA-Agent-System-v3/logs/debug/run_complete_fba_system_20250708_183426.log
DEBUG:asyncio:Using selector: EpollSelector
INFO:__main__:ğŸš€ Complete FBA System v3 initialized
INFO:__main__:ğŸ­ Processing supplier: poundwholesale-co-uk
INFO:__main__:ğŸ”— URL: https://www.poundwholesale.co.uk/
INFO:__main__:ğŸ“§ Email: info@theblacksmithmarket.com
INFO:__main__:ğŸ–¥ï¸ Headed mode: False
INFO:__main__:ğŸ“¦ Max products: 3
INFO:__main__:ğŸ”„ Force regenerate: True
INFO:__main__:ğŸ“¦ Archiving expected output files for verification...
INFO:__main__:Archive mode set to: ''
WARNING:__main__:Unknown archive mode: ''. Skipping archive.
INFO:tools.supplier_guard:ğŸ›¡ï¸ Supplier Guard initialized
INFO:tools.supplier_guard:ğŸ“¦ Archived supplier poundwholesale-co-uk to suppliers/poundwholesale-co-uk.bak_20250708143426UTC
INFO:__main__:ğŸ“¦ Archived existing data to: suppliers/poundwholesale-co-uk.bak_20250708143426UTC
INFO:__main__:ğŸ” Force regenerate requested: poundwholesale-co-uk. Generating automation package...
INFO:tools.supplier_guard:ğŸ›¡ï¸ Supplier Guard initialized
INFO:tools.supplier_script_generator:ğŸ§  Intelligent Supplier Script Generator initialized for: https://www.poundwholesale.co.uk/
INFO:tools.supplier_script_generator:ğŸ“ Supplier directory: suppliers/poundwholesale-co-uk
INFO:tools.supplier_script_generator:ğŸš€ Starting intelligent supplier script generation...
INFO:tools.supplier_script_generator:ğŸŒ Initializing browser connection...
INFO:tools.supplier_script_generator:âœ… Connected to existing Chrome debug instance
INFO:tools.supplier_script_generator:âœ… Using active user page: https://www.poundwholesale.co.uk/...
INFO:tools.supplier_script_generator:âœ… Already on target domain www.poundwholesale.co.uk, preserving current page state
INFO:tools.supplier_script_generator:ğŸ“„ Navigated to: https://www.poundwholesale.co.uk/
INFO:tools.supplier_script_generator:ğŸ§  Starting AI-powered element discovery...
INFO:tools.vision_discovery_engine:ğŸ” Enhanced Vision Discovery Engine initialized with multimodal AI capabilities
INFO:tools.supplier_script_generator:ğŸ” Discovering login elements...
INFO:tools.vision_discovery_engine:ğŸ” Starting enhanced multimodal login discovery...
INFO:tools.vision_discovery_engine:ğŸ“„ Extracting page HTML content...
DEBUG:tools.vision_discovery_engine:ğŸ§¹ Aggressively pruning HTML content for AI analysis...
WARNING:tools.vision_discovery_engine:HTML content for AI analysis was truncated to 15000 characters. The original size was 151403. AI context may be incomplete.
DEBUG:tools.vision_discovery_engine:âœ… HTML aggressively pruned to 15000 characters
INFO:tools.vision_discovery_engine:ğŸ“Š HTML content processed: 15000 characters after pruning
INFO:tools.vision_discovery_engine:ğŸ“¸ Capturing page screenshot...
INFO:tools.vision_discovery_engine:ğŸ§  Performing multimodal AI analysis for login elements...
DEBUG:tools.vision_discovery_engine:ğŸ§  Sending multimodal request to AI model...
DEBUG:httpcore.connection:connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
DEBUG:httpcore.connection:connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7eff88e005c0>
DEBUG:httpcore.connection:start_tls.started ssl_context=<ssl.SSLContext object at 0x7eff89805a50> server_hostname='api.openai.com' timeout=5.0
DEBUG:httpcore.connection:start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7eff88d17cb0>
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 08 Jul 2025 14:34:35 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-eywvpvgw4dvq99ktk9fwsqol'), (b'openai-processing-ms', b'2219'), (b'openai-version', b'2020-10-01'), (b'x-envoy-upstream-service-time', b'1825'), (b'x-ratelimit-limit-input-images', b'50000'), (b'x-ratelimit-limit-requests', b'500'), (b'x-ratelimit-limit-tokens', b'200000'), (b'x-ratelimit-remaining-input-images', b'49999'), (b'x-ratelimit-remaining-requests', b'499'), (b'x-ratelimit-remaining-tokens', b'195200'), (b'x-ratelimit-reset-input-images', b'1ms'), (b'x-ratelimit-reset-requests', b'120ms'), (b'x-ratelimit-reset-tokens', b'1.44s'), (b'x-request-id', b'req_3c97157c1536b652d2b86f25b9199149'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=7ssdhEK3_QDwI.qxfkO1B4mYDBHZb2p0dLapPozXfJc-1751985275-1.0.1.1-u7eT.ez5TFLVG_mbttmY3DlzdgK.SCxqKPho2FM4Ndqp5QB7CXSLxSGZK8Pp2FIPXlUbVa6pViQ9OQpZUbxFdBm1R1I6Jk6i3UlV14gvXkg; path=/; expires=Tue, 08-Jul-25 15:04:35 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=BRI6vcs5Y4AYRfLLdboTEL_HtvlFLXswCMryutkDk5s-1751985275134-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'95c04d7e7c85b47c-DXB'), (b'Content-Encoding', b'br'), (b'alt-svc', b'h3=":443"; ma=86400')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
DEBUG:tools.vision_discovery_engine:ğŸ¯ AI response received: {
  "email_selector": "input#email",
  "password_selector": "input#pass",
  "submit_selector": "butt...
INFO:tools.vision_discovery_engine:âœ… Login selectors extracted: {'email_selector': 'input#email', 'password_selector': 'input#pass', 'submit_selector': 'button#send2'}
INFO:tools.vision_discovery_engine:âœ… Login elements discovered successfully via multimodal analysis
INFO:tools.vision_discovery_engine:ğŸ” Validating discovered selectors...
INFO:tools.vision_discovery_engine:ğŸ” Validating login selectors...
WARNING:tools.vision_discovery_engine:âš ï¸ Discovered selectors failed validation
INFO:tools.vision_discovery_engine:ğŸ”„ Falling back to heuristic discovery...
INFO:tools.vision_discovery_engine:ğŸ”„ Running heuristic login discovery...
INFO:tools.vision_discovery_engine:âœ… Heuristic login discovery successful
INFO:tools.supplier_script_generator:ğŸ›ï¸ Discovering product and pagination selectors...
INFO:tools.vision_discovery_engine:ğŸ•·ï¸ Starting vision-based product and pagination selector discovery...
INFO:tools.vision_discovery_engine:ğŸ“„ Extracting page HTML content...
DEBUG:tools.vision_discovery_engine:ğŸ§¹ Aggressively pruning HTML content for AI analysis...
WARNING:tools.vision_discovery_engine:HTML content for AI analysis was truncated to 15000 characters. The original size was 151403. AI context may be incomplete.
DEBUG:tools.vision_discovery_engine:âœ… HTML aggressively pruned to 15000 characters
INFO:tools.vision_discovery_engine:ğŸ“Š HTML content processed: 15000 characters after pruning
INFO:tools.vision_discovery_engine:ğŸ“¸ Capturing page screenshot...
INFO:tools.vision_discovery_engine:ğŸ§  Performing multimodal AI analysis for product and pagination elements...
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 08 Jul 2025 14:34:47 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-eywvpvgw4dvq99ktk9fwsqol'), (b'openai-processing-ms', b'6306'), (b'openai-version', b'2020-10-01'), (b'x-envoy-upstream-service-time', b'5827'), (b'x-ratelimit-limit-input-images', b'50000'), (b'x-ratelimit-limit-requests', b'500'), (b'x-ratelimit-limit-tokens', b'200000'), (b'x-ratelimit-remaining-input-images', b'49999'), (b'x-ratelimit-remaining-requests', b'499'), (b'x-ratelimit-remaining-tokens', b'194888'), (b'x-ratelimit-reset-input-images', b'1ms'), (b'x-ratelimit-reset-requests', b'120ms'), (b'x-ratelimit-reset-tokens', b'1.533s'), (b'x-request-id', b'req_db783ae7344095e7f34a05a4b13f67a8'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'95c04db2df8bb47c-DXB'), (b'Content-Encoding', b'br'), (b'alt-svc', b'h3=":443"; ma=86400')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
DEBUG:tools.vision_discovery_engine:ğŸ¯ AI response received: {
  "product_container_selector": "li.product-item",
  "title_selector_relative": "a.product-item-li...
INFO:tools.vision_discovery_engine:âœ… Product and pagination selectors extracted: {'product_container_selector': 'li.product-item', 'title_selector_relative': 'a.product-item-link', 'price_selector_relative': 'span.price', 'url_selector_relative': 'a.product-item-link', 'ean_selector_relative': '', 'next_page_selector': 'a.action.next', 'category_links_selector': 'ul.items > li > a', 'breadcrumbs_selector': 'nav.breadcrumbs ol.items', 'image_selector_relative': 'img.product-image-photo', 'description_selector_relative': '', 'out_of_stock_selector_relative': 'div.stock.unavailable, span.stock.unavailable', 'previous_page_selector': 'a.action.previous', 'page_numbers_selector': 'ol.items > li > a', 'price_filter_selector': 'div.filter-options-item.price-filter', 'category_filter_selector': 'div.filter-options-item.category-filter', 'search_box_selector': 'input#search', 'products_per_page_selector': 'select.products-per-page', 'product limiter_selector': 'select.product-limiter'}
INFO:tools.vision_discovery_engine:âœ… Product and pagination elements discovered successfully via multimodal analysis
INFO:tools.vision_discovery_engine:ğŸ” Validating discovered selectors...
INFO:tools.vision_discovery_engine:ğŸ” Validating product and pagination selectors...
WARNING:tools.vision_discovery_engine:âš ï¸ Discovered selectors failed validation
INFO:tools.vision_discovery_engine:ğŸ”„ Falling back to heuristic discovery...
INFO:tools.vision_discovery_engine:ğŸ”„ Running heuristic product discovery...
INFO:tools.vision_discovery_engine:âœ… Product selector validated: .product-item (5 elements)
INFO:tools.vision_discovery_engine:âœ… Product selector validated: .product (5 elements)
INFO:tools.vision_discovery_engine:âœ… Product selector validated: .item (4 elements)
INFO:tools.vision_discovery_engine:âœ… Product selector validated: .title (3 elements)
INFO:tools.vision_discovery_engine:âœ… Product selector validated: h2 a (4 elements)
INFO:tools.vision_discovery_engine:âœ… Product selector validated: h3 a (2 elements)
INFO:tools.vision_discovery_engine:âœ… Product selector validated: .product-name (5 elements)
INFO:tools.vision_discovery_engine:âœ… Product selector validated: .product-item a (3 elements)
INFO:tools.vision_discovery_engine:âœ… Product selector validated: h2 a (4 elements)
INFO:tools.vision_discovery_engine:âœ… Product selector validated: a[href*='product'] (2 elements)
INFO:tools.vision_discovery_engine:âœ… Product selector validated: .product-item img (3 elements)
INFO:tools.vision_discovery_engine:âœ… Heuristic product discovery successful
INFO:tools.supplier_script_generator:ğŸ’¾ Saved login config: suppliers/poundwholesale-co-uk/config/login_config.json
INFO:tools.supplier_script_generator:ğŸ’¾ Saved product selectors: suppliers/poundwholesale-co-uk/config/product_selectors.json
INFO:tools.supplier_script_generator:ğŸ“ Generating scripts from templates...
INFO:tools.supplier_script_generator:ğŸ“ Generated login script: suppliers/poundwholesale-co-uk/scripts/poundwholesale-co-uk_login.py
INFO:tools.supplier_script_generator:ğŸ“ Generated product extractor script: suppliers/poundwholesale-co-uk/scripts/poundwholesale-co-uk_product_extractor.py
INFO:tools.supplier_script_generator:ğŸ§ª Starting test-after-generate validation...
INFO:tools.supplier_script_generator:ğŸ” Testing login script...
ERROR:tools.supplier_script_generator:Login script test failed: invalid syntax. Perhaps you forgot a comma? (poundwholesale-co-uk_login.py, line 230)
INFO:tools.supplier_script_generator:ğŸ¤– Performing AI failure analysis for login...
DEBUG:httpcore.connection:connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
DEBUG:httpcore.connection:connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7eff895ba840>
DEBUG:httpcore.connection:start_tls.started ssl_context=<ssl.SSLContext object at 0x7eff89a92ad0> server_hostname='api.openai.com' timeout=5.0
DEBUG:httpcore.connection:start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7eff895b94c0>
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 08 Jul 2025 14:35:00 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-eywvpvgw4dvq99ktk9fwsqol'), (b'openai-processing-ms', b'3208'), (b'openai-version', b'2020-10-01'), (b'x-envoy-upstream-service-time', b'3021'), (b'x-ratelimit-limit-input-images', b'50000'), (b'x-ratelimit-limit-requests', b'500'), (b'x-ratelimit-limit-tokens', b'200000'), (b'x-ratelimit-remaining-input-images', b'49999'), (b'x-ratelimit-remaining-requests', b'499'), (b'x-ratelimit-remaining-tokens', b'198966'), (b'x-ratelimit-reset-input-images', b'1ms'), (b'x-ratelimit-reset-requests', b'120ms'), (b'x-ratelimit-reset-tokens', b'310ms'), (b'x-request-id', b'req_c8474471e92495811eb702288066dde4'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=w_saQTsc62.pxpknbDcmagJpYepAaoJGMUmuPR5VjP4-1751985300-1.0.1.1-ooUjIWMgfclpjUsDCsUM.zCLnxy6J7eMLeTHcfWYS.1Ocq0w2HBjPP.oC6u2qBZtCMB207WnRqG8YG6VSmEc6qXVcT.h0TzEyxAiY4XwfzU; path=/; expires=Tue, 08-Jul-25 15:05:00 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=Ug.trn4FHKvpPR.8itVT7JcvyrIgAS6HTKdZ8XwKr0A-1751985300406-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'95c04e177ea6a6ab-DXB'), (b'Content-Encoding', b'br'), (b'alt-svc', b'h3=":443"; ma=86400')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
INFO:tools.supplier_script_generator:ğŸ¤– AI Diagnosis for login:
INFO:tools.supplier_script_generator:   Likely Cause: Incorrect email selector. The email input field in the login popup uses the placeholder 'Email address / Phone number' and does not have type='email'. It appears to be an input without type='email', so the selector input[type='email'] does not match it.
INFO:tools.supplier_script_generator:   Suggested Fix: Update the email selector to target the input field by placeholder or another attribute, e.g., input[placeholder='Email address / Phone number'] or use a more general selector like input[type='text'] within the login form.
INFO:tools.supplier_script_generator:ğŸ›ï¸ Testing product extraction script...
INFO:product_module:ğŸ›ï¸ Starting product extraction for 2 pages
INFO:product_module:ğŸ“„ Processing page 1
INFO:product_module:ğŸ” Found 20 product containers
INFO:product_module:âœ… Extracted 20 products from page 1
INFO:product_module:ğŸ§ª Test mode: stopping after 5 products
INFO:product_module:âœ… Product extraction completed: 20 total products
INFO:tools.supplier_script_generator:âœ… Validation completed - Login: False, Products: True
INFO:tools.supplier_script_generator:ğŸ“‹ Generating intelligent .supplier_ready file...
INFO:tools.supplier_guard:âœ… Created intelligent .supplier_ready file for poundwholesale-co-uk: suppliers/poundwholesale-co-uk/.supplier_ready
INFO:tools.supplier_script_generator:âœ… Created intelligent .supplier_ready file: suppliers/poundwholesale-co-uk/.supplier_ready
INFO:tools.supplier_script_generator:âœ… Intelligent supplier script generation completed successfully
INFO:__main__:âœ… Intelligent supplier automation package generated successfully for poundwholesale-co-uk
INFO:__main__:ğŸš€ Initializing centralized browser session...
INFO:utils.browser_manager:ğŸ”§ BrowserManager singleton initialized
INFO:utils.browser_manager:ğŸ”Œ Connecting to Chrome on debug port 9222
INFO:utils.browser_manager:ğŸ“„ Using existing context with 6 pages
INFO:utils.browser_manager:âœ… Connected to Chrome successfully
INFO:utils.browser_manager:ğŸ“„ Created new page #1 for https://www.poundwholesale.co.uk
INFO:utils.browser_manager:âœ… Page ready for https://www.poundwholesale.co.uk/
INFO:__main__:ğŸ” Performing dynamic supplier authentication...
INFO:__main__:ğŸ“¦ Loading dynamic supplier login script: suppliers/poundwholesale-co-uk/scripts/poundwholesale-co-uk_login.py
ERROR:__main__:âŒ Browser setup or dynamic authentication failed: invalid syntax. Perhaps you forgot a comma? (poundwholesale-co-uk_login.py, line 230)
Traceback (most recent call last):
  File "/mnt/c/Users/chris/Cloud-Drive_christianhaddad8@Gmail.com/Cloud-Drive/Full/claude code/Amazon-FBA-Agent-System-v3/run_complete_fba_system.py", line 433, in run_complete_system
    spec.loader.exec_module(supplier_login_module)
  File "<frozen importlib._bootstrap_external>", line 991, in exec_module
  File "<frozen importlib._bootstrap_external>", line 1129, in get_code
  File "<frozen importlib._bootstrap_external>", line 1059, in source_to_code
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/mnt/c/Users/chris/Cloud-Drive_christianhaddad8@Gmail.com/Cloud-Drive/Full/claude code/Amazon-FBA-Agent-System-v3/suppliers/poundwholesale-co-uk/scripts/poundwholesale-co-uk_login.py", line 230
    const submitBtn = document.querySelector('button[type='submit']');
    ^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
INFO:utils.browser_manager:ğŸ§¹ Starting browser cleanup...
INFO:utils.browser_manager:ğŸ—‘ï¸ Closed 1 cached pages
INFO:utils.browser_manager:ğŸ”Œ Disconnected from Chrome
INFO:utils.browser_manager:ğŸ­ Stopped Playwright
INFO:utils.browser_manager:âœ… Browser cleanup completed
INFO:utils.browser_manager:ğŸ§¹ Global browser cleanup completed
INFO:utils.browser_manager:ğŸ§¹ Starting browser cleanup...
INFO:utils.browser_manager:ğŸ—‘ï¸ Closed 0 cached pages
INFO:utils.browser_manager:âœ… Browser cleanup completed
INFO:utils.browser_manager:ğŸ§¹ Global browser cleanup completed
INFO:__main__:ğŸ§¹ Browser cleanup completed
DEBUG:asyncio:Using selector: EpollSelector
INFO:utils.browser_manager:ğŸ§¹ Starting browser cleanup...
INFO:utils.browser_manager:ğŸ—‘ï¸ Closed 0 cached pages
INFO:utils.browser_manager:âœ… Browser cleanup completed
INFO:utils.browser_manager:ğŸ§¹ Global browser cleanup completed
DEBUG:httpcore.connection:close.started
DEBUG:httpcore.connection:close.complete
DEBUG:httpcore.connection:close.started
DEBUG:httpcore.connection:close.complete
