INFO:__main__:ğŸ” Enhanced detailed logging enabled - output: /mnt/c/Users/chris/Cloud-Drive_christianhaddad8@Gmail.com/Cloud-Drive/Full/claude code/Amazon-FBA-Agent-System-v3/logs/debug/run_complete_fba_system_20250708_184659.log
DEBUG:asyncio:Using selector: EpollSelector
INFO:__main__:ğŸš€ Complete FBA System v3 initialized
INFO:__main__:ğŸ­ Processing supplier: poundwholesale-co-uk
INFO:__main__:ğŸ”— URL: https://www.poundwholesale.co.uk/
INFO:__main__:ğŸ“§ Email: info@theblacksmithmarket.com
INFO:__main__:ğŸ–¥ï¸ Headed mode: False
INFO:__main__:ğŸ“¦ Max products: 3
INFO:__main__:ğŸ”„ Force regenerate: True
INFO:__main__:ğŸ“¦ Archiving expected output files for verification...
INFO:__main__:Archive mode set to: ''
WARNING:__main__:Unknown archive mode: ''. Skipping archive.
INFO:tools.supplier_guard:ğŸ›¡ï¸ Supplier Guard initialized
INFO:tools.supplier_guard:ğŸ“¦ Archived supplier poundwholesale-co-uk to suppliers/poundwholesale-co-uk.bak_20250708144659UTC
INFO:__main__:ğŸ“¦ Archived existing data to: suppliers/poundwholesale-co-uk.bak_20250708144659UTC
INFO:__main__:ğŸ” Force regenerate requested: poundwholesale-co-uk. Generating automation package...
INFO:tools.supplier_guard:ğŸ›¡ï¸ Supplier Guard initialized
INFO:tools.supplier_script_generator:ğŸ§  Intelligent Supplier Script Generator initialized for: https://www.poundwholesale.co.uk/
INFO:tools.supplier_script_generator:ğŸ“ Supplier directory: suppliers/poundwholesale-co-uk
INFO:tools.supplier_script_generator:ğŸš€ Starting intelligent supplier script generation...
INFO:tools.supplier_script_generator:ğŸŒ Initializing browser connection...
INFO:tools.supplier_script_generator:âœ… Connected to existing Chrome debug instance
INFO:tools.supplier_script_generator:âœ… Using active user page: https://www.poundwholesale.co.uk/...
INFO:tools.supplier_script_generator:âœ… Already on target domain www.poundwholesale.co.uk, preserving current page state
INFO:tools.supplier_script_generator:ğŸ“„ Navigated to: https://www.poundwholesale.co.uk/
INFO:tools.supplier_script_generator:ğŸ§  Starting AI-powered element discovery...
INFO:tools.vision_discovery_engine:ğŸ” Enhanced Vision Discovery Engine initialized with multimodal AI capabilities
INFO:tools.supplier_script_generator:ğŸ” Discovering login elements...
INFO:tools.vision_discovery_engine:ğŸ” Starting enhanced multimodal login discovery...
INFO:tools.vision_discovery_engine:ğŸ“„ Extracting page HTML content...
DEBUG:tools.vision_discovery_engine:ğŸ§¹ Aggressively pruning HTML content for AI analysis...
WARNING:tools.vision_discovery_engine:HTML content for AI analysis was truncated to 15000 characters. The original size was 151182. AI context may be incomplete.
DEBUG:tools.vision_discovery_engine:âœ… HTML aggressively pruned to 15000 characters
INFO:tools.vision_discovery_engine:ğŸ“Š HTML content processed: 15000 characters after pruning
INFO:tools.vision_discovery_engine:ğŸ“¸ Capturing page screenshot...
INFO:tools.vision_discovery_engine:ğŸ§  Performing multimodal AI analysis for login elements...
DEBUG:tools.vision_discovery_engine:ğŸ§  Sending multimodal request to AI model...
DEBUG:httpcore.connection:connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
DEBUG:httpcore.connection:connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f99e4eba750>
DEBUG:httpcore.connection:start_tls.started ssl_context=<ssl.SSLContext object at 0x7f99e57749d0> server_hostname='api.openai.com' timeout=5.0
DEBUG:httpcore.connection:start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f99e4eba4b0>
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 08 Jul 2025 14:47:07 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-eywvpvgw4dvq99ktk9fwsqol'), (b'openai-processing-ms', b'1538'), (b'openai-version', b'2020-10-01'), (b'x-envoy-upstream-service-time', b'1391'), (b'x-ratelimit-limit-input-images', b'50000'), (b'x-ratelimit-limit-requests', b'500'), (b'x-ratelimit-limit-tokens', b'200000'), (b'x-ratelimit-remaining-input-images', b'49999'), (b'x-ratelimit-remaining-requests', b'499'), (b'x-ratelimit-remaining-tokens', b'195200'), (b'x-ratelimit-reset-input-images', b'1ms'), (b'x-ratelimit-reset-requests', b'120ms'), (b'x-ratelimit-reset-tokens', b'1.44s'), (b'x-request-id', b'req_09c77e8d0d09ab13b3cf7ef38da899f2'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=mw.qogPl8aWHrxTuKFSYtxKrmU79YsGNUPz_v8gwp3I-1751986027-1.0.1.1-H6iWJLPcAcuWTztzj6AiUhiJSM6t0BfyuOJDT3.MeJee1lSImLWurBqpRz_H36fPbJX5.BFN4t0tOBmC98.OjRsOz4e7ty615DZqTaJ_UBw; path=/; expires=Tue, 08-Jul-25 15:17:07 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=oSpcR4GSfcHVW4mFLlC1k_uU_G1J8_GyMz9m6trh5SI-1751986027387-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'95c05fe96bdcb482-DXB'), (b'Content-Encoding', b'br'), (b'alt-svc', b'h3=":443"; ma=86400')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
DEBUG:tools.vision_discovery_engine:ğŸ¯ AI response received: {
  "email_selector": "input#email",
  "password_selector": "input[name='login[password]']",
  "subm...
INFO:tools.vision_discovery_engine:âœ… Login selectors extracted: {'email_selector': 'input#email', 'password_selector': "input[name='login[password]']", 'submit_selector': 'button#send2'}
INFO:tools.vision_discovery_engine:âœ… Login elements discovered successfully via multimodal analysis
INFO:tools.vision_discovery_engine:ğŸ” Validating discovered selectors...
INFO:tools.vision_discovery_engine:ğŸ” Validating login selectors...
WARNING:tools.vision_discovery_engine:âš ï¸ Discovered selectors failed validation
INFO:tools.vision_discovery_engine:ğŸ”„ Falling back to heuristic discovery...
INFO:tools.vision_discovery_engine:ğŸ”„ Running heuristic login discovery...
INFO:tools.supplier_script_generator:ğŸ›ï¸ Discovering product and pagination selectors...
INFO:tools.vision_discovery_engine:ğŸ•·ï¸ Starting vision-based product and pagination selector discovery...
INFO:tools.vision_discovery_engine:ğŸ“„ Extracting page HTML content...
DEBUG:tools.vision_discovery_engine:ğŸ§¹ Aggressively pruning HTML content for AI analysis...
WARNING:tools.vision_discovery_engine:HTML content for AI analysis was truncated to 15000 characters. The original size was 151351. AI context may be incomplete.
DEBUG:tools.vision_discovery_engine:âœ… HTML aggressively pruned to 15000 characters
INFO:tools.vision_discovery_engine:ğŸ“Š HTML content processed: 15000 characters after pruning
INFO:tools.vision_discovery_engine:ğŸ“¸ Capturing page screenshot...
INFO:tools.vision_discovery_engine:ğŸ§  Performing multimodal AI analysis for product and pagination elements...
DEBUG:httpcore.connection:close.started
DEBUG:httpcore.connection:close.complete
DEBUG:httpcore.connection:connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
DEBUG:httpcore.connection:connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f99e53209b0>
DEBUG:httpcore.connection:start_tls.started ssl_context=<ssl.SSLContext object at 0x7f99e57749d0> server_hostname='api.openai.com' timeout=5.0
DEBUG:httpcore.connection:start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f99e5320620>
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 08 Jul 2025 14:47:19 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-eywvpvgw4dvq99ktk9fwsqol'), (b'openai-processing-ms', b'4340'), (b'openai-version', b'2020-10-01'), (b'x-envoy-upstream-service-time', b'4193'), (b'x-ratelimit-limit-input-images', b'50000'), (b'x-ratelimit-limit-requests', b'500'), (b'x-ratelimit-limit-tokens', b'200000'), (b'x-ratelimit-remaining-input-images', b'49999'), (b'x-ratelimit-remaining-requests', b'499'), (b'x-ratelimit-remaining-tokens', b'194887'), (b'x-ratelimit-reset-input-images', b'1ms'), (b'x-ratelimit-reset-requests', b'120ms'), (b'x-ratelimit-reset-tokens', b'1.533s'), (b'x-request-id', b'req_0c6c49da5251aaa85a8e2e464db9df90'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'95c060210a4cd115-DXB'), (b'Content-Encoding', b'br'), (b'alt-svc', b'h3=":443"; ma=86400')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
DEBUG:tools.vision_discovery_engine:ğŸ¯ AI response received: {
  "product_container_selector": "li.product-item",
  "title_selector_relative": "a.product-item-li...
INFO:tools.vision_discovery_engine:âœ… Product and pagination selectors extracted: {'product_container_selector': 'li.product-item', 'title_selector_relative': 'a.product-item-link', 'price_selector_relative': 'span.price', 'url_selector_relative': 'a.product-item-link', 'ean_selector_relative': '', 'next_page_selector': 'a.action.next', 'category_links_selector': 'ul.categories-list li a', 'breadcrumbs_selector': 'nav.breadcrumbs ol.items li.item a', 'image_selector_relative': 'img.product-image-photo', 'description_selector_relative': 'div.product-item-details div.product-item-description', 'out_of_stock_selector_relative': 'div.stock.unavailable, span.stock.unavailable', 'previous_page_selector': 'a.action.previous', 'page_numbers_selector': 'ol.items li.item a', 'price_filter_selector': 'div.filter-options-item.filter-price, div.price-range-slider', 'category_filter_selector': 'div.filter-options-item.filter-category select, div.filter-options-item.filter-category ul.items li a', 'search_box_selector': 'input#search', 'products_per_page_selector': 'select.products-per-page', 'product limiter_selector': 'select.products-per-page'}
INFO:tools.vision_discovery_engine:âœ… Product and pagination elements discovered successfully via multimodal analysis
INFO:tools.vision_discovery_engine:ğŸ” Validating discovered selectors...
INFO:tools.vision_discovery_engine:ğŸ” Validating product and pagination selectors...
WARNING:tools.vision_discovery_engine:âš ï¸ Discovered selectors failed validation
INFO:tools.vision_discovery_engine:ğŸ”„ Falling back to heuristic discovery...
INFO:tools.vision_discovery_engine:ğŸ”„ Running heuristic product discovery...
INFO:tools.vision_discovery_engine:âœ… Product selector validated: .product-item (5 elements)
INFO:tools.vision_discovery_engine:âœ… Product selector validated: .product (5 elements)
INFO:tools.vision_discovery_engine:âœ… Product selector validated: .item (4 elements)
INFO:tools.vision_discovery_engine:âœ… Product selector validated: .title (3 elements)
INFO:tools.vision_discovery_engine:âœ… Product selector validated: h2 a (4 elements)
INFO:tools.vision_discovery_engine:âœ… Product selector validated: h3 a (2 elements)
INFO:tools.vision_discovery_engine:âœ… Product selector validated: .product-name (5 elements)
INFO:tools.vision_discovery_engine:âœ… Product selector validated: .product-item a (3 elements)
INFO:tools.vision_discovery_engine:âœ… Product selector validated: h2 a (4 elements)
INFO:tools.vision_discovery_engine:âœ… Product selector validated: a[href*='product'] (2 elements)
INFO:tools.vision_discovery_engine:âœ… Product selector validated: .product-item img (3 elements)
INFO:tools.vision_discovery_engine:âœ… Heuristic product discovery successful
WARNING:tools.supplier_script_generator:âš ï¸ Login discovery failed, creating empty config
INFO:tools.supplier_script_generator:ğŸ’¾ Saved product selectors: suppliers/poundwholesale-co-uk/config/product_selectors.json
INFO:tools.supplier_script_generator:ğŸ“ Generating scripts from templates...
INFO:tools.supplier_script_generator:ğŸ“ Generated login script: suppliers/poundwholesale-co-uk/scripts/poundwholesale-co-uk_login.py
INFO:tools.supplier_script_generator:ğŸ“ Generated product extractor script: suppliers/poundwholesale-co-uk/scripts/poundwholesale-co-uk_product_extractor.py
INFO:tools.supplier_script_generator:ğŸ§ª Starting test-after-generate validation...
INFO:tools.supplier_script_generator:ğŸ” Testing login script...
INFO:login_module:ğŸ” Starting login to https://www.poundwholesale.co.uk/
INFO:login_module:âŒ Not logged in
INFO:login_module:ğŸ”— Clicking login trigger: header a:has-text('Sign in')
INFO:login_module:âœ… Email filled
INFO:login_module:âœ… Password filled
INFO:login_module:ğŸš« Dismissing modal overlay: .modals-overlay
INFO:login_module:ğŸš« Forcibly hid modal overlays with JavaScript
INFO:login_module:ğŸ¯ Enhanced submit button visibility
INFO:login_module:âœ… Submit button clicked
INFO:login_module:âŒ Not logged in
WARNING:login_module:âŒ Login verification failed - analyzing current page state...
INFO:login_module:ğŸ“¸ Screenshot saved: logs/debug/login_failure_screenshot_20250708_184811.png
INFO:login_module:ğŸ“„ Current page HTML length: 505810 characters
WARNING:login_module:ğŸš¨ Detected potential error indicators: ['code']
ERROR:login_module:Failed to analyze login failure: object str can't be used in 'await' expression
INFO:tools.supplier_script_generator:ğŸ¤– Performing AI failure analysis for login...
DEBUG:httpcore.connection:connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
DEBUG:httpcore.connection:connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f99e52f1910>
DEBUG:httpcore.connection:start_tls.started ssl_context=<ssl.SSLContext object at 0x7f99e5a3aa50> server_hostname='api.openai.com' timeout=5.0
DEBUG:httpcore.connection:start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f99e52f1610>
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 08 Jul 2025 14:48:17 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-eywvpvgw4dvq99ktk9fwsqol'), (b'openai-processing-ms', b'2459'), (b'openai-version', b'2020-10-01'), (b'x-envoy-upstream-service-time', b'2341'), (b'x-ratelimit-limit-input-images', b'50000'), (b'x-ratelimit-limit-requests', b'500'), (b'x-ratelimit-limit-tokens', b'200000'), (b'x-ratelimit-remaining-input-images', b'49999'), (b'x-ratelimit-remaining-requests', b'499'), (b'x-ratelimit-remaining-tokens', b'199013'), (b'x-ratelimit-reset-input-images', b'1ms'), (b'x-ratelimit-reset-requests', b'120ms'), (b'x-ratelimit-reset-tokens', b'295ms'), (b'x-request-id', b'req_ccf16c40daaa8624ba839d2fd7033df7'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=oxXIrBkLNuQA58YVUo6qBYUAEFKZi8cee1kcuoW1UtY-1751986097-1.0.1.1-G0HBRbRzniiF1G7HIeGA2XI40z2bBmemCNnunEQgluspxoq_Uc9Hs6Lu_CvAPwlupyUCq_Wr4e0eVKP_2MepXa4j__ohqMWTh7sBtluRWZw; path=/; expires=Tue, 08-Jul-25 15:18:17 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=8iH4zpbYDnIht.Ey.xb1G00IrBrXyVCK_WpluMHLQNQ-1751986097824-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'95c061a09af2d115-DXB'), (b'Content-Encoding', b'br'), (b'alt-svc', b'h3=":443"; ma=86400')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
INFO:tools.supplier_script_generator:ğŸ¤– AI Diagnosis for login:
INFO:tools.supplier_script_generator:   Likely Cause: The login page or login form is not visible or not loaded on the page at the time of the script execution.
INFO:tools.supplier_script_generator:   Suggested Fix: Verify that the script navigates to the correct login page URL before attempting to interact with login elements. Ensure the login form is present and visible before performing login actions. If the login form is on a separate page or requires a specific user action to appear, update the script to handle this navigation or interaction.
INFO:tools.supplier_script_generator:ğŸ›ï¸ Testing product extraction script...
INFO:product_module:ğŸ›ï¸ Starting product extraction for 2 pages
INFO:product_module:ğŸ“„ Processing page 1
INFO:product_module:ğŸ” Found 20 product containers
INFO:product_module:âœ… Extracted 20 products from page 1
INFO:product_module:ğŸ§ª Test mode: stopping after 5 products
INFO:product_module:âœ… Product extraction completed: 20 total products
INFO:tools.supplier_script_generator:âœ… Validation completed - Login: False, Products: True
INFO:tools.supplier_script_generator:ğŸ“‹ Generating intelligent .supplier_ready file...
INFO:tools.supplier_guard:âœ… Created intelligent .supplier_ready file for poundwholesale-co-uk: suppliers/poundwholesale-co-uk/.supplier_ready
INFO:tools.supplier_script_generator:âœ… Created intelligent .supplier_ready file: suppliers/poundwholesale-co-uk/.supplier_ready
INFO:tools.supplier_script_generator:âœ… Intelligent supplier script generation completed successfully
INFO:__main__:âœ… Intelligent supplier automation package generated successfully for poundwholesale-co-uk
INFO:__main__:ğŸš€ Initializing centralized browser session...
INFO:utils.browser_manager:ğŸ”§ BrowserManager singleton initialized
INFO:utils.browser_manager:ğŸ”Œ Connecting to Chrome on debug port 9222
INFO:utils.browser_manager:ğŸ“„ Using existing context with 8 pages
INFO:utils.browser_manager:âœ… Connected to Chrome successfully
INFO:utils.browser_manager:ğŸ“„ Created new page #1 for https://www.poundwholesale.co.uk
INFO:utils.browser_manager:âœ… Page ready for https://www.poundwholesale.co.uk/
INFO:__main__:ğŸ” Performing dynamic supplier authentication...
INFO:__main__:ğŸ“¦ Loading dynamic supplier login script: suppliers/poundwholesale-co-uk/scripts/poundwholesale-co-uk_login.py
INFO:poundwholesale-co-uk_login:ğŸ” Starting login to https://www.poundwholesale.co.uk/
INFO:poundwholesale-co-uk_login:âŒ Not logged in
INFO:poundwholesale-co-uk_login:ğŸ”— Clicking login trigger: header a:has-text('Sign in')
INFO:poundwholesale-co-uk_login:âœ… Email filled
INFO:poundwholesale-co-uk_login:âœ… Password filled
INFO:poundwholesale-co-uk_login:ğŸš« Dismissing modal overlay: .modals-overlay
